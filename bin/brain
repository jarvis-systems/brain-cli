#!/usr/bin/env php
<?php

require __DIR__ . '/../vendor/autoload.php';

use Illuminate\Container\Container;
use Illuminate\Events\Dispatcher;
use Illuminate\Console\Application;
use BrainCLI\Foundation\Application as BrainApplication;
use BrainCLI\Database\DatabaseManager;
use BrainCLI\Config\ConfigManager;
use Illuminate\Support\Facades\Facade;

defined("DS") || define("DS", DIRECTORY_SEPARATOR);


$container = new BrainApplication();

Container::setInstance($container);
$container->instance('app', $container);

// Enable facades and configuration repository
Facade::setFacadeApplication($container);
ConfigManager::boot($container);

$events = new Dispatcher($container);

DatabaseManager::boot($container, $events);

$app = new Application($container, $events, \BrainCLI\Support\Brain::version());

$app->add(new \BrainCLI\Console\Commands\InitCommand());
$app->add(new \BrainCLI\Console\Commands\CheckCommand());

$status = $app->run();

exit($status);
